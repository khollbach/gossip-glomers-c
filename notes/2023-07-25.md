# Dev Notes

2023-07-25

## Accomplishments ğŸ†

- Design message schemas; settle on "event-driven control flow" approach
- Implement `client_response_handler`, `conch_response_handler`

## Recap âª

### Conch Request

```json
{
  "src": "n_",
  /* dest is always n0 */
  "dest": "n0",
  "body": { "type": "conch_request", "original_client_request": _ }
}
```

### Conch Response

```json
{
  // src is always n0
  "src": "n0",
  "dest": "n_",
  "body": { "type": "conch_response", "conch_value": _, client_id": "c_" }
}
```

### Conch Release

```json
{
  "src": "n_",
  /* dest is always n0 */
  "dest": "n0",
  "body": { "type": "conch_release", "conch_value": _ }
}
```

### Follower Node

| Status | Incoming       | Outgoing                                                   |
| ------ | -------------- | ---------------------------------------------------------- |
| âœ…     | client request | `client_response_handler` (conch request)                  |
| âœ…     | conch response | `conch_response_handler` (client response + conch release) |

### Leader Node

| Status | Incoming       | Outgoing                                                   |
| ------ | -------------- | ---------------------------------------------------------- |
| âœ…     | client request | `client_response_handler` (conch request)                  |
| âœ…     | conch response | `conch_response_handler` (client response + conch release) |
| ğŸ”²     | conch request  | enqueue                                                    |
| ğŸ”²     | conch release  | "update conch holder"                                      |
| ğŸ”²     | "dequeue"[^1]  | "updated conch holder", conch response                     |

## TODOs ğŸ“

- []

---

[^1]: Only if conch is available
